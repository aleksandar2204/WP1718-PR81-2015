<!DOCTYPE html>
<html>
<head>
    <style>
        .dropdown-menu-right {
            right: 0;
            left: auto;
        }
        
    </style>
    <meta charset="utf-8" />
    <title></title>
    <script src="Scripts/jquery-1.10.2.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="Scripts/jquery-1.10.2.js"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            let korisnik;
            let korisnickoIme = localStorage.getItem("Ulogovan");

            $('#zaprofil').hide();
            $('#zaizmenu').hide();
            $('#divDodajVoznju').hide();
            $('#divIzmeniVoznju').hide();
            $('#divOtkaziVoznju').hide();

            $('#zaprofilDispecer').hide();
            $('#zaizmenuDispecer').hide();

            $('#zadodajVozaca').hide();
            $('#zadodajVoznju').hide();

            $('#zaprofilVozaca').hide();
            $('#zaizmenuVozaca').hide();

            function vratiStatusVoznje(id) {
                switch (id) {
                    case 0: return "Kreirana";
                    case 1: return "Formirana";
                    case 2: return "Obradjena";
                    case 3: return "Prihvaćena";
                    case 4: return "Otkazana";
                    case 5: return "Neuspešna";
                    case 6: return "Uspešna";
                }
            }

            let Korisnik = {
                KorisnickoIme: `${korisnickoIme}`
            };

            $.ajax({
                type: 'POST',
                url: '/api/Wellcome',
                data: JSON.stringify(Korisnik),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    //alert('Sifra je: ' + data.Lozinka);
                    korisnik = data;
                    if (korisnik.Uloga == 2) {
                        $('#dispecer').hide();
                        $('#vozac').hide();
                        $('#musterija').show();
                        $.get("/api/Voznja", function (data, status) {
                            let table = "<table border=\"1\">";
                            table += "<tr><th>ID voznje</th><th>Datum</th><th>Mesto polaska</th><th>Tip automobila</th><th>Odrediste</th><th>Iznos</th><th>Komentar</th><th>Status voznje</th><th>Opcije</th></tr>";

                            for (voznja in data) {
                                if (data[voznja].Musterija == localStorage.getItem("Ulogovan")) {
                                    table += ("<tr><td>" + data[voznja].IdVoznje + "</td><td>" + data[voznja].VremePorudzbine + "</td><td>" + data[voznja].Lokacija.Adresa.UlicaBroj + ", " + data[voznja].Lokacija.Adresa.NaseljenoMjesto + ", " + data[voznja].Lokacija.Adresa.PozivniBroj + "</td><td>");
                                    switch (data[voznja].Automobil) {
                                        case 0:
                                            table += "Putnicki automobil";
                                            break;
                                        case 1:
                                            table += "Kombi vozilo";
                                            break;
                                    }
                                    table += "</td>";

                                    if (data[voznja].Odrediste.Adresa.UlicaBroj == "") {
                                        table += ("<td>/</td>");
                                    }
                                    else {
                                        table += ("</td><td>" + data[voznja].Odrediste.Adresa.UlicaBroj + ", " + data[voznja].Odrediste.Adresa.NaseljenoMesto + " " + data[voznja].Odrediste.Adresa.PozivniBroj + "</td>");
                                    }

                                    if (data[voznja].Iznos != "0") {
                                        table += ("<td>" + data[voznja].Iznos + "</td>");
                                    }
                                    else {
                                        table += ("<td>/</td>");
                                    }

                                     table += ('<td><textarea rows="5" cols="30" disabled>');
     
                                     if (data[voznja].Komentar.Opis == "") {
                                         table += ("Komentar nije dodat!" + "</textarea></td>");
                                     } else {
                                         table += ("Korisnicko ime: " + data[voznja].Komentar.KorisnickoIme + "\n\nOpis: " + data[voznja].Komentar.Opis + "\n\nOcena: " + data[voznja].Komentar.OcenaVoznje + "\nDatum: " + data[voznja].Komentar.DatumObjave + "</textarea ></td >");
                                     }
     
                                     if (data[voznja].Status == 0) {
                                         table += '<td>Kreirana</td>';
                                     } else if (data[voznja].Status == 1) {
                                         table += '<td>Formirana</td>';
                                     } else if (data[voznja].Status == 2) {
                                         table += '<td>Obradjena</td>';
                                     } else if (data[voznja].Status == 3) {
                                         table += '<td>Prihvacena</td>';
                                     } else if (data[voznja].Status == 4) {
                                         table += '<td>Otkazana</td>';
                                     } else if (data[voznja].Status == 5) {
                                         table += '<td>Neuspjesna</td>';
                                     } else if (data[voznja].Status == 6) {
                                         table += '<td>Uspjesna</td>';
                                    }
                                    table += "<td>";
                                    if (vratiStatusVoznje(data[voznja].Status) == "Kreirana") {
                                        table += (`<button value=${data[voznja].IdVoznje} id="odustani">Odustani</button><br /><br />`);
                                        table += (`<button value=${data[voznja].IdVoznje} id="izmeniV">Izmeni</button>`);
                                    } else if (vratiStatusVoznje(data[voznja].Status) == "Uspešna") {
                                        table += (`<input type="button" value=" Komentar " id="dodajKomentarUspesna" class="kombtn" name=${data[voznja].IdVoznje} />`);
                                    } else {
                                        table += ("Nedostupne");
                                    }
                                    table += "</tr>";
                                }
                            }
                            table += "</table>";
                            $('#PrikazKorisnik').append(table);
                        });
                    } else if (korisnik.Uloga == 1) {
                        $('#musterija').hide();
                        $('#dispecer').show();
                        $('#vozac').hide();
                        $.get("/api/Voznja", function (data, status) {
                            let table = "<table border=\"1\">";
                            table += '<table border=1><tr><th>Id vožnje</th><th>Datum</th><th>Mušterija</th><th>Vozač</th><th >Mesto polaska</th><th>Tip auta</th><th>Ordedište</th><th>Iznos</th><th>Komentar</th><th>Status vožnje</th><th>Opcije</th></tr>';

                            for (voznja in data) {
                                if (data[voznja].Dispecer == localStorage.getItem("Ulogovan")) {
                                    table += ("<tr><td>" + data[voznja].IdVoznje + "</td><td>" + data[voznja].VremePorudzbine + "</td>");

                                    if (data[voznja].Musterija == "") {
                                        table += '<td>/</td>';
                                    } else {
                                        table += ('<td>' + data[voznja].Musterija + '</td>');
                                    }

                                    if (data[voznja].Vozac == "") {
                                        table += '<td>/</td>';
                                    } else {
                                        table += ('<td>' + data[voznja].Vozac + '</td>');
                                    }

                                    table += ('<td>' + data[voznja].Lokacija.Adresa.UlicaBroj + ", " + data[voznja].Lokacija.Adresa.NaseljenoMesto + " " + data[voznja].Lokacija.Adresa.PozivniBroj + "</td><td>");

                                    switch (data[voznja].Automobil) {
                                        case 0:
                                            table += "Putnički";
                                            break;
                                        case 1:
                                            table += "Kombi";
                                            break;
                                    }


                                    if (data[voznja].Odrediste.Adresa.UlicaBroj == "") {
                                        table += ("</td><td>/" + "</td>");
                                    }
                                    else {
                                        table += ("</td><td>" + data[voznja].Odrediste.Adresa.UlicaBroj + ", " + data[voznja].Odrediste.Adresa.NaseljenoMesto + " " + data[voznja].Odrediste.Adresa.PozivniBroj + "</td>");
                                    }

                                    if (data[voznja].Iznos != "0") {
                                        table += ("<td>" + data[voznja].Iznos + "</td>");
                                    } else {
                                        table += ("<td>/</td>");
                                    }

                                    table += ('<td><textarea rows="5" cols="30" disabled>');

                                    if (data[voznja].Komentar.Opis == "") {
                                        table += ("Komentar nije dodat!" + "</textarea ></td >");
                                    } else {
                                        table += ("Korisnicko ime: " + data[voznja].Komentar.KorisnickoIme + "\n\nOpis: " + data[voznja].Komentar.Opis + "\n\nOcena: " + data[voznja].Komentar.Ocena + "\nDatum: " + data[voznja].Komentar.DatumObjave + "</textarea ></td >");
                                    }

                                    table += ("<td>" + vratiStatusVoznje(data[voznja].Status) + "</td> <td>");


                                    if (vratiStatusVoznje(data[voznja].Status) == "Kreirana") {
                                        table += (`<input type="button" value="Obradi" id="obradi" class="obradibtn" name=${data[voznja].IdVoznje} /><br /><br />`);
                                    } else {
                                        table += ("Nedostupne");
                                    }
                                    table += (`</td></tr>`)

                                }
                            }
                            table += '</table>';
                            $('#PrikazDispecer').append(table);
                        });
                    }
                    else {
                        $('#musterija').hide();
                        $('#dispecer').hide();
                        $('#vozac').show();
                    }
                }
            })


            // Odustani od voznje iz korisnika


            $(document).on('click', '#odustani', function () {
                $('#PrikazKorisnik').hide();
                $('#divOtkaziVoznju').toggle(500);
            });

            $('#OtkaziKorisnik').click(function () {
                let id = `${$('#odustani').val()}`;
                let komentar = {
                    Opis: `${$('#OpisKorisnik').val()}`,
                    OcenaVoznje: `${$('#OcenaVoznjeKorisnik').val()}`
                };

                let OtkaziVoznju = {
                    Komentar: komentar,
                    Musterija: localStorage.getItem("Ulogovan")
                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Voznja/PutOtkaz/' + id,
                    data: JSON.stringify(OtkaziVoznju),
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (!data) {
                            alert("Vožnja nije otkazana!");
                        } else {
                            alert("Uspešno ste otkazali vožnju!");
                            $(location).attr('href', 'wellcome.html');
                        }
                    }
                })
            })

            $(document).on('click', '#izmeniV', function () {
                $('#PrikazKorisnik').hide();
                $('#divIzmeniVoznju').toggle(500);
            });

            $('#IzmeniVoznju').click(function () {
                let id = `${$('#izmeniV').val()}`;
                let tip = `${$('#TipVozilaIzmena').val()}`;
                if (tip == "KOMBI VOZILO") {
                    tip = "KOMBIVOZILA";
                }

                let adresa = {
                    UlicaBroj: `${$('#korisnikUlicaBrojIzmena').val()}`,
                    NaseljenoMjesto: `${$('#korisnikNaseljenoMestoIzmena').val()}`,
                    PozivniBroj: `${$('#korisnikPozivniBrojIzmena').val()}`
                };

                let lokacija = {
                    X: `${$('#korisnikLokacijaXIzmena').val()}`,
                    Y: `${$('#korisnikLokacijaYIzmena').val()}`,
                    Adresa: adresa
                };

                let NovaVoznjaKorisnika = {
                    Lokacija: lokacija,
                    Automobil: tip,
                }

                $.ajax({
                    type: 'PUT',
                    url: '/api/Voznja/Put/' + id,
                    data: JSON.stringify(NovaVoznjaKorisnika),
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (!data) {
                            alert("Vožnja nije izmenjena!");
                        } else {
                            alert("Uspešno ste izmenili vožnju!");
                            $(location).attr('href', 'wellcome.html');
                        }
                    }
                })
            })
            
            // Kraj odustani od voznje iz korisnika

            $('#profilDispecer').click(function () {
                $('#zaizmenuDispecer').hide();
                $('#zadodajVozaca').hide();
                $('#1D').text(korisnik.KorisnickoIme);
                $('#2D').text(korisnik.Lozinka);
                $('#3D').text(korisnik.Ime);
                $('#4D').text(korisnik.Prezime);
                $('#5D').text(korisnik.JMBG);
                if (korisnik.Pol == 1) {
                    $('#6D').text("Zenski");
                } else {
                    $('#6D').text("Muski");
                }
                $('#7D').text(korisnik.Telefon);
                $('#8D').text(korisnik.Email);
                $('#zaprofilDispecer').toggle(500);
            })

            $('#izmeniDispecer').click(function () {
                $('#zaprofilDispecer').hide();
                $('#zadodajVozaca').hide();
                $('#zaizmenuDispecer').toggle(500);
            })

            $('#IzmeniDispecer').click(function () {
                let dispecerIzmena = {
                    Id: korisnik.Id,
                    KorisnickoIme: `${$('#KorisnickoImeD').val()}`,
                    Lozinka: `${$('#LozinkaD').val()}`,
                    Ime: `${$('#ImeD').val()}`,
                    Prezime: `${$('#PrezimeD').val()}`,
                    Pol: korisnik.Pol,
                    JMBG: `${$('#JMBGD').val()}`,
                    Telefon: `${$('#TelefonD').val()}`,
                    Email: `${$('#EmailD').val()}`,
                    Uloga: 'DISPECER',
                    Voznja: "nema voznje",
                };


                $.ajax({
                    type: 'PUT',
                    url: '/api/Dispecer/' + korisnik.Id,
                    data: JSON.stringify(dispecerIzmena),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            localStorage.setItem("Ulogovan", dispecerIzmena.KorisnickoIme);
                            alert('Data was succesfully captured');
                            $(location).attr('href', 'wellcome.html');
                        }
                        else {
                            alert('Error');
                        }
                    }
                })
            })

            $('#odjaviDispecer').click(function () {
                localStorage.setItem("Ulogovan", null);
                $(location).attr('href', 'index.html');
            })

            $('#profil').click(function () {
                $('#zaizmenu').hide();
                $('#divIzmeniVoznju').hide();
                $('divDodajVoznju').hide();
                $('divOtkaziVoznju').hide();
                $('#1').text(korisnik.KorisnickoIme);
                $('#2').text(korisnik.Lozinka);
                $('#3').text(korisnik.Ime);
                $('#4').text(korisnik.Prezime);
                $('#5').text(korisnik.JMBG);
                if (korisnik.Pol == 1) {
                    $('#6').text("Zenski");
                } else {
                    $('#6').text("Muski");
                }
                $('#7').text(korisnik.Telefon);
                $('#8').text(korisnik.Email);
                $('#zaprofil').toggle(500);
            })

            $('#izmeni').click(function () {
                $('#zaprofil').hide();
                $('#divIzmeniVoznju').hide();
                $('divDodajVoznju').hide();
                $('divOtkaziVoznju').hide();
                $('#zaizmenu').toggle(500);
            })

            $('#Izmeni').click(function () {
                let korisnikIzmena = {
                    Id: korisnik.Id,
                    KorisnickoIme: `${$('#KorisnickoIme').val()}`,
                    Lozinka: `${$('#Lozinka').val()}`,
                    Ime: `${$('#Ime').val()}`,
                    Prezime: `${$('#Prezime').val()}`,
                    Pol: korisnik.Pol,
                    JMBG: `${$('#JMBG').val()}`,
                    Telefon: `${$('#Telefon').val()}`,
                    Email: `${$('#Email').val()}`,
                    Uloga: 'MUSTERIJA',
                    Voznja: "nema voznje",
                };
                

                $.ajax({
                    type: 'PUT',
                    url: '/api/Korisnik/' + korisnik.Id,
                    data: JSON.stringify(korisnikIzmena),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            localStorage.setItem("Ulogovan", korisnikIzmena.KorisnickoIme);
                            alert('Data was succesfully captured');
                            $(location).attr('href', 'wellcome.html');
                        }
                        else {
                            alert('Error');
                        }
                    }
                })
            })

            $('#odjavi').click(function () {
                localStorage.setItem("Ulogovan", null);
                $(location).attr('href', 'index.html');
            })

            $('#DodajVozaca').click(function () {
                let adresa = {
                    UlicaBroj: `${$('#UlicaBrojVozaca').val()}`,
                    NaseljenoMjesto: `${$('#NaseljenoMestoVozaca').val()}`,
                    PozivniBroj: `${$('#PozivniBrojVozaca').val()}`
                };

                let lokacija = {
                    X: `${$('#XVozaca').val()}`,
                    Y: `${$('#YVozaca').val()}`,
                    Adresa: adresa
                };


                let automobil = {
                    Vozac: `${$('#KorisnickoImeVozaca').val()}`,
                    GodisteAutomobila: `${$('#GodisteAutomobila').val()}`,
                    BrojRegistarskeOznake: `${$('#BrojRegistarskeOznake').val()}`,
                    BrojTaksiVozila: `${$('#BrojTaksiVozila').val()}`,
                    Tip: `${$('#tip').val()}`,
                };

                let vozac = {
                    KorisnickoIme: `${$('#KorisnickoImeVozaca').val()}`,
                    Lozinka: `${$('#LozinkaVozaca').val()}`,
                    Ime: `${$('#ImeVozaca').val()}`,
                    Prezime: `${$('#PrezimeVozaca').val()}`,
                    Pol: `${$('#PolVozaca').val()}`,
                    JMBG: `${$('#JMBGVozaca').val()}`,
                    Telefon: `${$('#TelefonVozaca').val()}`,
                    Email: `${$('#EmailVozaca').val()}`,
                    Uloga: 'VOZAC',
                    Voznja: "nema voznje",
                    Lokacija: lokacija,
                    Automobil: automobil
                };

                $.ajax({
                    type: 'POST',
                    url: '/api/Vozac/',
                    data: JSON.stringify(vozac),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Data was succesfully captured');
                            $(location).attr('href', 'wellcome.html');
                        }
                        else {
                            alert('Error');
                        }
                    }
                })

            })

            $('#dodajVozaca').click(function () {
                $('#zaprofilDispecer').hide();
                $('#zaizmenuDispecer').hide();
                $('#zadodajVozaca').toggle(500);
            })

            // Dodavanje voznje iz dispecera

            $('#dodajVoznju').click(function () {
                $('#zaprofilDispecer').hide();
                $('#zaizmenuDispecer').hide();
                $('#zadodajVozaca').hide();
                $('#zadodajVoznju').toggle(500);
            })

            
            $('#dispecerDodajVoznju').click(function () {
                $.get("/api/Vozac", function (data, status) {
                    let pom = `${$('#dispecerTipVozila').val()}`
                    let pom1;
                    let koliko = 0;
                    if (pom == "KOMBI VOZILO") {
                        pom1 = 1;
                    }
                    else {
                        pom1 = 0;
                    }

                    let table = "<table border='1'><tr><td><select id=\"vozac\" name=\"VozacVoznja\">";

                    for (driver in data) {
                        if (data[driver].Automobil.Tip == pom1 && data[driver].Zauzet == false) {
                            table += "<option>" + data[driver].KorisnickoIme + "</option>";
                            koliko++;
                        }
                    }

                    table += "</select></td></tr></table><button id=\"dodajVoznjuDispecer2\" type=\"button\"><b>Dodaj voznju</b></button>";
                    if (koliko == 0) {
                        alert('Trenutno nema slobodnih vozaca sa trazenim automobilom');
                        $(location).attr('href', 'wellcome.html');
                    } else {
                        $("#zadodajVoznju").append(table);
                    }
                });
            });

            $(document).on('click', '#dodajVoznjuDispecer2', function () {
                
                $("#DodavanjeVoznjeDispecer").show();
                let pom = `${$('#vozac').val()}`;
                localStorage.setItem("Vozac", pom);
                let pomAuto = `${$('#dispecerTipVozila').val()}`;
                let auto;
                if (pomAuto == "KOMBI VOZILO")
                    auto = "KOMBIVOZILA";
                else
                    auto = "PUTNICKIAUTOMOBIL";

                let adresa = {
                    UlicaBroj: `${$('#dispecerUlicaBroj').val()}`,
                    NaseljenoMjesto: `${$('#dispecerNaseljenoMesto').val()}`,
                    PozivniBroj: `${$('#dispecerPozivniBroj').val()}`
                };

                let lokacija = {
                    X: `${$('#dispecerLokacijaX').val()}`,
                    Y: `${$('#dispecerLokacijaY').val()}`,
                    Adresa: adresa
                };

                let NovaVoznjaDispecera = {
                    Lokacija: lokacija,
                    Automobil: auto,
                    Vozac: localStorage.getItem("Vozac"),
                    Dispecer: localStorage.getItem("Ulogovan"),
                }

                $.ajax({
                    type: 'POST',
                    url: '/api/Dispecer/PostD',
                    data: JSON.stringify(NovaVoznjaDispecera),
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (!data) {
                            alert("Vožnja nije dodata!");
                        } else {
                            alert("Uspešno ste dodali novu vožnju!");
                            $(location).attr('href', 'wellcome.html');
                        }
                    }
                })
            });

            // Dodavanje Voznje iz korisnika

            $('#dodajVoznjuKorisnik').click(function () {
                $('#zaprofil').hide();
                $('#zaizmenu').hide();
                $('#PrikazKorisnik').hide();
                $('#divDodajVoznju').toggle(500);
            })

            $('#DodajVoznju').click(function () {
                let adresa = {
                    UlicaBroj: `${$('#korisnikUlicaBroj').val()}`,
                    NaseljenoMjesto: `${$('#korisnikNaseljenoMesto').val()}`,
                    PozivniBroj: `${$('#korisnikPozivniBroj').val()}`
                };

                let lokacija = {
                    X: `${$('#korisnikLokacijaX').val()}`,
                    Y: `${$('#korisnikLokacijaY').val()}`,
                    Adresa: adresa
                };

                let NovaVoznjaKorisnika = {
                    Lokacija: lokacija,
                    Automobil: `${$('#TipVozila').val()}`,
                    Musterija: localStorage.getItem("Ulogovan"),
                }

                $.ajax({
                    type: 'POST',
                    url: '/api/Registracija/Post',
                    data: JSON.stringify(NovaVoznjaKorisnika),
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (!data) {
                            alert("Vožnja nije dodata!");
                        } else {
                            alert("Uspešno ste dodali novu vožnju!");
                            $(location).attr('href', 'wellcome.html');
                        }
                    }
                })
            })

            /*$('#izmeniVoznjuKorisnik').click(function () {
                $('#zaprofil').hide();
                $('#zaizmenu').hide();
                $('#divDodajVoznju').hide();
                $('#divOtkaziVoznju').hide();
                $('#divIzmeniVoznju').toggle(500);
            })*/

            

            /*$('#odustaniOdVoznjeKorisnik').click(function () {
                $('#zaprofil').hide();
                $('#zaizmenu').hide();
                $('#divDodajVoznju').hide();
                $('#divIzmeniVoznju').hide();
                $('#divOtkaziVoznju').toggle(500);
            })*/

            // Kad se uloguje VOZAC

            $('#profilVozaca').click(function () {
                $('zaizmenuVozaca').hide();

                $('#1v').text(korisnik.KorisnickoIme);
                $('#2v').text(korisnik.Lozinka);
                $('#3v').text(korisnik.Ime);
                $('#4v').text(korisnik.Prezime);
                $('#5v').text(korisnik.JMBG);
                if (korisnik.Pol == 1) {
                    $('#6v').text("Zenski");
                } else {
                    $('#6v').text("Muski");
                }
                $('#7v').text(korisnik.Telefon);
                $('#8v').text(korisnik.Email);
                $('#9v').text(korisnik.Lokacija.X);
                $('#10v').text(korisnik.Lokacija.Y);
                $('#11v').text(korisnik.Lokacija.Adresa.UlicaBroj);
                $('#12v').text(korisnik.Lokacija.Adresa.NaseljenoMjesto);
                $('#13v').text(korisnik.Lokacija.Adresa.PozivniBroj);
                $('#14v').text(korisnik.Automobil.GodisteAutomobila);
                $('#15v').text(korisnik.Automobil.BrojRegistarskeOznake);
                $('#16v').text(korisnik.Automobil.BrojTaksiVozila);
                if (korisnik.Automobil.Tip == 0) {
                    $('#17v').text("Kombi vozilo");
                }
                else {
                    $('#17v').text("Putnicki automobil");
                }
                $('#zaprofilVozaca').toggle(500);
            })

            $('#IzmeniVozaca').click(function () {
                let adresa = {
                    UlicaBroj: `${$('#UlicaBrojV').val()}`,
                    NaseljenoMjesto: `${$('#NaseljenoMestoV').val()}`,
                    PozivniBroj: `${$('#PozivniBrojV').val()}`
                }

                let lokacija = {
                    X: `${$('#XV').val()}`,
                    Y: `${$('#YV').val()}`,
                    Adresa: adresa
                };


                let automobil = {
                    Vozac: `${$('#KorisnickoImeV').val()}`,
                    GodisteAutomobila: `${$('#GodisteAutomobilaV').val()}`,
                    BrojRegistarskeOznake: `${$('#BrojRegistarskeOznakeV').val()}`,
                    BrojTaksiVozila: `${$('#BrojTaksiVozilaV').val()}`,
                    Tip: `${$('#TipV').val()}`,
                };

                let vozac = {
                    KorisnickoIme: `${$('#KorisnickoImeV').val()}`,
                    Lozinka: `${$('#LozinkaV').val()}`,
                    Ime: `${$('#ImeV').val()}`,
                    Prezime: `${$('#PrezimeV').val()}`,
                    Pol: korisnik.Pol,
                    JMBG: `${$('#JMBGV').val()}`,
                    Telefon: `${$('#TelefonV').val()}`,
                    Email: `${$('#EmailV').val()}`,
                    Uloga: 'VOZAC',
                    Voznja: "nema voznje",
                    Lokacija: lokacija,
                    Automobil: automobil
                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Vozac/' + korisnik.Id,
                    data: JSON.stringify(vozac),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            localStorage.setItem("Ulogovan", vozac.KorisnickoIme);
                            alert('Data was succesfully captured');
                            $(location).attr('href', 'wellcome.html');
                        }
                        else {
                            alert('Error');
                        }
                    }
                })
            })

            $('#promenaLokacijeVozacaDugme').click(function () {
                let adresa = {
                    UlicaBroj: `${$('#UlicaBrojZaLokaciju').val()}`,
                    NaseljenoMjesto: `${$('#NaseljenoMestoZaLokaciju').val()}`,
                    PozivniBroj: `${$('#PozivniBrojZaLokaciju').val()}`
                }

                let lokacija = {
                    X: `${$('#XZaLokaciju').val()}`,
                    Y: `${$('#YZaLokaciju').val()}`,
                    Adresa: adresa
                };

                let vozac = {
                    Id: korisnik.Id,
                    Lokacija: lokacija
                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Vozac/',
                    data: JSON.stringify(vozac),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            localStorage.setItem("Ulogovan", korisnik.KorisnickoIme);
                            alert('Data was succesfully captured');
                            $(location).attr('href', 'wellcome.html');
                        }
                        else {
                            alert('Error');
                        }
                    }
                })

            })

            $('#izmeniVozaca').click(function () {
                $('#zaprofilVozaca').hide();
                $('#zaizmenuVozaca').toggle(500);
            })

            $('#odjaviVozaca').click(function () {
                localStorage.setItem("Ulogovan", null);
                $(location).attr('href', 'index.html');
            })
        });

    </script>
</head>
<body>
    <div id="musterija">
        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" href="#"><img style="max-width:100px; margin-top: -7px;" src="TaxiLogo.png"></a>
                </div>
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Musterija</a></li>
                </ul>
                <ul class="nav navbar-nav">
                    <li><a href="#" id="dodajVoznjuKorisnik">Dodaj voznju</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown" style="float:right">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            Opcije
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="#" id="profil">Profil</a></li>
                            <li><a href="#" id="izmeni">Izmeni</a></li>
                            <li><a href="#" id="odjavi">Odjavi</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>
        <br />
        <br />
        <br />
        <div id="PrikazKorisnik">
            <h2>Prikaz svih voznji: </h2>
        </div>
        <div id="divDodajVoznju">
            <h2>Kreiraj voznju:</h2>
            <hr />
            <table>
                <tr><td colsapn="2"><hr /></td></tr>
                <tr><td>Koordinata X:</td><td><input type="text" style="margin:5px;" name="X" id="korisnikLokacijaX" /></td></tr>
                <tr><td>Koordinata Y:</td><td><input type="text" style="margin:5px;" name="Y" id="korisnikLokacijaY" /></td></tr>
                <tr><td>Ulica i broj:</td><td><input type="text" style="margin:5px;" name="UlicaBroj" id="korisnikUlicaBroj"/></td></tr>
                <tr><td>Naseljeno mesto:</td><td><input type="text" style="margin:5px;" name="NaseljenoMesto" id="korisnikNaseljenoMesto" /></td></tr>
                <tr><td>Pozivni broj:</td><td><input type="text" style="margin:5px;" name="PozivniBroj" id="korisnikPozivniBroj" /></td></tr>
                <tr>
                    <td>Željeni tip automobila:</td>
                    <td>
                        <select name="Tip" class="form-control" id="TipVozila">
                            <option>PUTNICKI AUTOMOBIL</option>
                            <option>KOMBI VOZILO</option>
                        </select>
                    </td>
                </tr>
                <tr><td colspan="2" align="right"><input type="button" style="margin:5px;" name="DodajVoznju" id="DodajVoznju" value="Dodaj" /></td></tr>
            </table>
        </div>
        <div id="divIzmeniVoznju">
            <h2>Izmeni voznju:</h2>
            <hr />
            <table>
                <tr><td colsapn="2"><hr /></td></tr>
                <tr><td>Koordinata X:</td><td><input type="text" style="margin:5px;" name="X" id="korisnikLokacijaXIzmena" /></td></tr>
                <tr><td>Koordinata Y:</td><td><input type="text" style="margin:5px;" name="Y" id="korisnikLokacijaYIzmena" /></td></tr>
                <tr><td>Ulica i broj:</td><td><input type="text" style="margin:5px;" name="UlicaBroj" id="korisnikUlicaBrojIzmena" /></td></tr>
                <tr><td>Naseljeno mesto:</td><td><input type="text" style="margin:5px;" name="NaseljenoMesto" id="korisnikNaseljenoMestoIzmena" /></td></tr>
                <tr><td>Pozivni broj:</td><td><input type="text" style="margin:5px;" name="PozivniBroj" id="korisnikPozivniBrojIzmena" /></td></tr>
                <tr>
                    <td>Željeni tip automobila:</td>
                    <td>
                        <select name="Tip" class="form-control" id="TipVozilaIzmena">
                            <option>PUTNICKI AUTOMOBIL</option>
                            <option>KOMBI VOZILO</option>
                        </select>
                    </td>
                </tr>
                <tr><td colspan="2" align="right"><input type="button" style="margin:5px;" name="IzmeniVoznju" id="IzmeniVoznju" value="Izmeni" /></td></tr>
            </table>
        </div>
        <div id="divOtkaziVoznju">
            <h2>Komentar za voznju:</h2>
            <hr />
            <table>
                <tr><td colsapn="2"><hr /></td></tr>
                <tr><td>Opis:</td><td><input type="text" style="margin:5px;" name="Opis" id="OpisKorisnik" /></td></tr>
                <tr><td>Ocena voznje:</td>
                    <td><select name="OcenaVoznje" id="OcenaVoznjeKorisnik" class="form-control" >
                        <option>0</option> 
                        <option>1</option> 
                        <option>2</option> 
                        <option>3</option> 
                        <option>4</option> 
                        <option>5</option> 
                        </select>
                    </td>
                </tr>
                <tr><td colspan="2" align="right"><input type="button" style="margin:5px;" name="OtkaziVoznju" id="OtkaziKorisnik" value="Otkazi" /></td></tr>
            </table>
        </div>
        <div id="zaprofil">
            <h2>Korisnicki profil</h2>
            <hr />
            <table>
                <tr><th>Korisnicko ime:</th><td id="1"></td></tr>
                <tr><th>Lozinka:</th><td id="2"></td></tr>
                <tr><th>Ime:</th><td id="3"></td></tr>
                <tr><th>Prezime:</th><td id="4"></td></tr>
                <tr><th>JMBG:</th><td id="5"></td></tr>
                <tr><th>Pol:</th><td id="6"></td></tr>
                <tr><th>Kontakt Telefon:</th><td id="7"></td></tr>
                <tr><th>Email:</th><td id="8"></td></tr>
            </table>
        </div>
        <div id="zaizmenu">
            <table>
                <tr><th>Korisnicko ime:</th><td><input type="text" name="KorisnickoIme" id="KorisnickoIme" style="margin:5px" /></td></tr>
                <tr><th>Lozinka:</th><td><input type="password" name="Lozinka" id="Lozinka" style="margin:5px" /></td></tr>
                <tr><th>Ime:</th><td><input type="text" name="Ime" id="Ime" style="margin:5px" /></td></tr>
                <tr><th>Prezime:</th><td><input type="text" name="Prezime" id="Prezime" style="margin:5px" /></td></tr>
                <tr><th>JMBG:</th><td><input type="text" name="JMBG" id="JMBG" style="margin:5px" /></td></tr>
                <tr><th>Kontakt Telefon:</th><td><input type="text" name="Telefon" id="Telefon" style="margin:5px" /></td></tr>
                <tr><th>Email:</th><td><input type="email" name="Email" id="Email" style="margin:5px" /></td></tr>
                <tr><td colspan="2"><hr /></td></tr>
                <tr><td colspan="2" align="right"><b><input type="button" value="Izmeni" id="Izmeni" /></b></td></tr>
            </table>
        </div>
    </div>
    <div id="dispecer">
        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" href="#"><img style="max-width:100px; margin-top: -7px;" src="TaxiLogo.png"></a>
                </div>
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Dispecer</a></li>

                </ul>
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            Dodaj
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="#" id="dodajVozaca">Vozaca</a></li>
                            <li><a href="#" id="dodajVoznju">Voznju</a></li>
                        </ul>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown" style="float:right">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            Opcije
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="#" id="profilDispecer">Profil</a></li>
                            <li><a href="#" id="izmeniDispecer">Izmeni</a></li>
                            <li><a href="#" id="odjaviDispecer">Odjavi</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>
        <br />
        <br />
        <br />
        <div id="PrikazDispecer">
            <h2>Prikaz voznji:</h2>
        </div>
        <div id="zadodajVozaca">
            <h2>Dodavanje vozaca</h2>
            <hr />
            <table>
                <tr><th>Korisnicko ime:</th><td><input type="text" name="KorisnickoIme" id="KorisnickoImeVozaca" style="margin:5px" /></td></tr>
                <tr><th>Lozinka:</th><td><input type="password" name="Lozinka" id="LozinkaVozaca" style="margin:5px" /></td></tr>
                <tr><th>Ime:</th><td><input type="text" name="Ime" id="ImeVozaca" style="margin:5px" /></td></tr>
                <tr><th>Prezime:</th><td><input type="text" name="Prezime" id="PrezimeVozaca" style="margin:5px" /></td></tr>
                <tr><th>JMBG:</th><td><input type="text" name="JMBG" id="JMBGVozaca" style="margin:5px" /></td></tr>
                <tr>
                    <th>Pol:</th>
                    <td>
                        <select name="Pol" class="form-control" id="PolVozaca">
                            <option>MUSKO</option>
                            <option>ZENSKO</option>
                        </select>
                    </td>
                </tr>
                <tr><th>Kontakt Telefon:</th><td><input type="text" name="Telefon" id="TelefonVozaca" style="margin:5px" /></td></tr>
                <tr><th>Email:</th><td><input type="email" name="Email" id="EmailVozaca" style="margin:5px" /></td></tr>
                <tr><th>X:</th><td><input type="text" name="X" id="XVozaca" style="margin:5px" /></td></tr>
                <tr><th>Y:</th><td><input type="text" name="Y" id="YVozaca" style="margin:5px" /></td></tr>
                <tr><th>Ulica i broj:</th><td><input type="text" name="UlicaBroj" id="UlicaBrojVozaca" style="margin:5px" /></td></tr>
                <tr><th>Naseljeno mjesto:</th><td><input type="text" name="NaseljenoMesto" id="NaseljenoMestoVozaca" style="margin:5px" /></td></tr>
                <tr><th>Pozivni broj:</th><td><input type="text" name="PozivniBroj" id="PozivniBrojVozaca" style="margin:5px" /></td></tr>
                <tr><th>Godiste automobila:</th><td><input type="text" name="GodisteAutomobila" id="GodisteAutomobila" style="margin:5px" /></td></tr>
                <tr><th>Broj registarske oznake:</th><td><input type="text" name="BrojRegistarskeOznake" id="BrojRegistarskeOznake" style="margin:5px" /></td></tr>
                <tr><th>Broj taksi vozila:</th><td><input type="text" name="BrojTaksiVozila" id="BrojTaksiVozila" style="margin:5px" /></td></tr>
                <tr><th>Tip automobila:</th>
                <td><select name="Tip" class="form-control" id="tip">
                    <option>PUTNICKI AUTOMOBIL</option>
                    <option>KOMBI VOZILO</option>
                </select></td></tr>
                <tr><td colspan="2"><hr /></td></tr>
                <tr><td colspan="2" align="right"><b><input type="button" value="Dodaj" id="DodajVozaca" /></b></td></tr>
            </table>
        </div>
        <div id="zadodajVoznju">
            <h2>Kreiraj voznju:</h2>
            <hr />
            <table>
                <tr><td colsapn="2"><hr /></td></tr>
                <tr><td>Koordinata X:</td><td><input type="text" style="margin:5px;" name="X" id="dispecerLokacijaX" /></td></tr>
                <tr><td>Koordinata Y:</td><td><input type="text" style="margin:5px;" name="Y" id="dispecerLokacijaY" /></td></tr>
                <tr><td>Ulica i broj:</td><td><input type="text" style="margin:5px;" name="UlicaBroj" id="dispecerUlicaBroj" /></td></tr>
                <tr><td>Naseljeno mesto:</td><td><input type="text" style="margin:5px;" name="NaseljenoMesto" id="dispecerNaseljenoMesto" /></td></tr>
                <tr><td>Pozivni broj:</td><td><input type="text" style="margin:5px;" name="PozivniBroj" id="dispecerPozivniBroj" /></td></tr>
                <tr>
                    <td>Željeni tip automobila:</td>
                    <td>
                        <select name="Tip" class="form-control" id="dispecerTipVozila">
                            <option>PUTNICKI AUTOMOBIL</option>
                            <option>KOMBI VOZILO</option>
                        </select>
                    </td>
                </tr>
                <tr><td colspan="2" align="right"><input type="button" style="margin:5px;" name="DodajVoznju" id="dispecerDodajVoznju" value="Dodaj" /></td></tr>
            </table>
        </div>
        <div id="zaprofilDispecer">
            <h2>Dispecerski profil</h2>
            <hr />
            <table>
                <tr><th>Korisnicko ime:</th><td id="1D"></td></tr>
                <tr><th>Lozinka:</th><td id="2D"></td></tr>
                <tr><th>Ime:</th><td id="3D"></td></tr>
                <tr><th>Prezime:</th><td id="4D"></td></tr>
                <tr><th>JMBG:</th><td id="5D"></td></tr>
                <tr><th>Pol:</th><td id="6D"></td></tr>
                <tr><th>Kontakt Telefon:</th><td id="7D"></td></tr>
                <tr><th>Email:</th><td id="8D"></td></tr>
            </table>
        </div>
        <div id="zaizmenuDispecer">
            <table>
                <tr><th>Korisnicko ime:</th><td><input type="text" name="KorisnickoIme" id="KorisnickoImeD" style="margin:5px" /></td></tr>
                <tr><th>Lozinka:</th><td><input type="password" name="Lozinka" id="LozinkaD" style="margin:5px" /></td></tr>
                <tr><th>Ime:</th><td><input type="text" name="Ime" id="ImeD" style="margin:5px" /></td></tr>
                <tr><th>Prezime:</th><td><input type="text" name="Prezime" id="PrezimeD" style="margin:5px" /></td></tr>
                <tr><th>JMBG:</th><td><input type="text" name="JMBG" id="JMBGD" style="margin:5px" /></td></tr>
                <tr><th>Kontakt Telefon:</th><td><input type="text" name="Telefon" id="TelefonD" style="margin:5px" /></td></tr>
                <tr><th>Email:</th><td><input type="email" name="Email" id="EmailD" style="margin:5px" /></td></tr>
                <tr><td colspan="2"><hr /></td></tr>
                <tr><td colspan="2" align="right"><b><input type="button" value="Izmeni" id="IzmeniDispecer" /></b></td></tr>
            </table>
        </div>
    </div>
    <div id="vozac">
        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" href="#"><img style="max-width:100px; margin-top: -7px;" src="TaxiLogo.png"></a>
                </div>
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Vozac</a></li>

                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown" style="float:right">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            Opcije
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="#" id="profilVozaca">Profil</a></li>
                            <li><a href="#" id="izmeniVozaca">Izmeni</a></li>
                            <li><a href="#" id="odjaviVozaca">Odjavi</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>
        <br />
        <br />
        <br />
        <div id="zaprofilVozaca">
            <h2>Vozac profil</h2>
            <hr />
            <table>
                <tr><th>Korisnicko ime:</th><td id="1v"></td></tr>
                <tr><th>Lozinka:</th><td id="2v"></td></tr>
                <tr><th>Ime:</th><td id="3v"></td></tr>
                <tr><th>Prezime:</th><td id="4v"></td></tr>
                <tr><th>JMBG:</th><td id="5v"></td></tr>
                <tr><th>Pol:</th><td id="6v"></td></tr>
                <tr><th>Kontakt Telefon:</th><td id="7v"></td></tr>
                <tr><th>Email:</th><td id="8v"></td></tr>
                <tr><th>X:</th><td id="9v"></td></tr>
                <tr><th>Y:</th><td id="10v"></td></tr>
                <tr><th>Ulica i broj:</th><td id="11v"></td></tr>
                <tr><th>Naseljeno mjesto:</th><td id="12v"></td></tr>
                <tr><th>Pozivni broj:</th><td id="13v"></td></tr>
                <tr><th>Godiste automobila:</th><td id="14v"></td></tr>
                <tr><th>Broj registarske oznake:</th><td id="15v"></td></tr>
                <tr><th>Broj taksi vozila:</th><td id="16v"></td></tr>
                <tr><th>Tip automobila:</th><td id="17v"></td></tr>
            </table>
        </div>
        <div id="zaizmenuVozaca">
            <table>
                <tr><th>Korisnicko ime:</th><td><input type="text" name="KorisnickoIme" id="KorisnickoImeV" style="margin:5px" /></td></tr>
                <tr><th>Lozinka:</th><td><input type="password" name="Lozinka" id="LozinkaV" style="margin:5px" /></td></tr>
                <tr><th>Ime:</th><td><input type="text" name="Ime" id="ImeV" style="margin:5px" /></td></tr>
                <tr><th>Prezime:</th><td><input type="text" name="Prezime" id="PrezimeV" style="margin:5px" /></td></tr>
                <tr><th>JMBG:</th><td><input type="text" name="JMBG" id="JMBGV" style="margin:5px" /></td></tr>
                <tr>
                    <th>Pol:</th>
                    <td>
                        <select name="Pol" class="form-control" id="PolV">
                            <option>MUSKO</option>
                            <option>ZENSKO</option>
                        </select>
                    </td>
                </tr>
                <tr><th>Kontakt Telefon:</th><td><input type="text" name="Telefon" id="TelefonV" style="margin:5px" /></td></tr>
                <tr><th>Email:</th><td><input type="email" name="Email" id="EmailV" style="margin:5px" /></td></tr>
                <tr><th>X:</th><td><input type="text" name="X" id="XV" style="margin:5px" /></td></tr>
                <tr><th>Y:</th><td><input type="text" name="Y" id="YV" style="margin:5px" /></td></tr>
                <tr><th>Ulica i broj:</th><td><input type="text" name="UlicaBroj" id="UlicaBrojV" style="margin:5px" /></td></tr>
                <tr><th>Naseljeno mjesto:</th><td><input type="text" name="NaseljenoMjesto" id="NaseljenoMestoV" style="margin:5px" /></td></tr>
                <tr><th>Pozivni broj:</th><td><input type="text" name="PozivniBroj" id="PozivniBrojV" style="margin:5px" /></td></tr>
                <tr><th>Godiste automobila:</th><td><input type="text" name="GodisteAutomobila" id="GodisteAutomobilaV" style="margin:5px" /></td></tr>
                <tr><th>Broj registarske oznake:</th><td><input type="text" name="BrojRegistarskeOznake" id="BrojRegistarskeOznakeV" style="margin:5px" /></td></tr>
                <tr><th>Broj taksi vozila:</th><td><input type="text" name="BrojTaksiVozila" id="BrojTaksiVozilaV" style="margin:5px" /></td></tr>
                <tr>
                    <th>Tip automobila:</th>
                    <td>
                        <select name="Tip" class="form-control" id="TipV">
                            <option>PUTNICKI AUTOMOBIL</option>
                            <option>KOMBI VOZILO</option>
                        </select>
                    </td>
                </tr>
                <tr><td colspan="2"><hr /></td></tr>
                <tr><td colspan="2" align="right"><b><input type="button" value="Izmeni" id="IzmeniVozaca" /></b></td></tr>
            </table>
        </div>
        <div id="promenaLokacijeVozaca">
            <table>
                <tr><th>X:</th><td><input type="text" name="X" id="XZaLokaciju" style="margin:5px" /></td></tr>
                <tr><th>Y:</th><td><input type="text" name="Y" id="YZaLokaciju" style="margin:5px" /></td></tr>
                <tr><th>Ulica i broj:</th><td><input type="text" name="UlicaBroj" id="UlicaBrojZaLokaciju" style="margin:5px" /></td></tr>
                <tr><th>Naseljeno mjesto:</th><td><input type="text" name="NaseljenoMjesto" id="NaseljenoMestoZaLokaciju" style="margin:5px" /></td></tr>
                <tr><th>Pozivni broj:</th><td><input type="text" name="PozivniBroj" id="PozivniBrojZaLokaciju" style="margin:5px" /></td></tr>
                <tr><td colspan="2"><hr /></td></tr>
                <tr><td colspan="2" align="right"><b><input type="button" value="Izmeni" id="promenaLokacijeVozacaDugme" /></b></td></tr>
            </table>
        </div>
    </div>
</body>
</html>
